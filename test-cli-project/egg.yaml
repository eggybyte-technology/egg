config_version: "1.0"
project_name: "test-cli-project"
version: "v1.0.0"
module_prefix: "github.com/eggybyte-technology/test-cli-project"
docker_registry: "ghcr.io/eggybyte-technology"

build:
  platforms: ["linux/amd64", "linux/arm64"]
  go_runtime_image: "eggybyte-go-alpine"

env:
  global:
    LOG_LEVEL: "info"
    KUBERNETES_NAMESPACE: "prod"
  backend:
    DATABASE_DSN: "user:pass@tcp(mysql:3306)/app?charset=utf8mb4&parseTime=True"
  frontend:
    FLUTTER_BASE_HREF: "/"

backend_defaults:
  ports:
    http: 8080
    health: 8081
    metrics: 9091

kubernetes:
  resources:
    configmaps:
      global-config:
        FEATURE_A: "on"
    secrets:
      jwtkey:
        KEY: "super-secret"

backend:
  user-service:
    image_name: "user-service"
    kubernetes:
      service:
        clusterIP: { name: "user-svc" }
        headless: { name: "user-svc-headless", publishNotReadyAddresses: true }
    env:
      common:
        SERVICE_NAME: "user-service"
      docker:
        RATE_LIMIT_QPS: "${cfgv:global-config:FEATURE_A}"
      kubernetes:
        APP_CONFIGMAP_NAME: "${cfg:global-config}"
        JWT_TOKEN: "${sec:jwtkey:KEY}"
        PROXY_TARGET: "${svc:user-service@headless}"

frontend: {}

database:
  enabled: false
  image: "mysql:9.4"
  port: 3306
  root_password: "rootpass"
  database: "app"
  user: "user"
  password: "pass"
